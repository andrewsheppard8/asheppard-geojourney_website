{% extends "base.html" %}

{% block title %}Admin Site Updates{% endblock %}

{% block content %}
<div class="admin-page">
    <h1>Admin: Manage Site Updates</h1>

    <!-- Add New Update -->
    <h2>Add New Update</h2>
    <form method="POST" style="margin-bottom:30px;">
        <label>Title:<br>
            <input type="text" name="new_title" required>
        </label><br>
        <label>Description (Markdown allowed):<br>
            <textarea name="new_description" rows="6"></textarea>
        </label><br>
        <label>Location:<br>
            <input type="text" name="new_location">
        </label><br>
        <label>Date:<br>
            <input type="date" name="new_date">
        </label><br>
        <button type="submit">Add Update</button>
    </form>

    <hr>

    <!-- Edit Existing Updates -->
    <h2>Edit Existing Updates</h2>
    {% for post in posts %}
    <div
        style="border:1px solid #ccc; padding:15px; margin-bottom:20px; display:flex; gap:20px; flex-wrap:wrap; border-radius:8px; align-items:flex-start;">
        <form method="POST">
            <input type="hidden" name="edit_id" value="{{ post['id'] }}">
            <label>Title:<br>
                <input type="text" name="edit_title" value="{{ post['title'] }}">
            </label><br>
            <label>Description (Markdown allowed):<br>
                <textarea name="edit_description" rows="6">{{ post['description'] }}</textarea>
            </label><br>
            <label>Location:<br>
                <input type="text" name="edit_location" value="{{ post['location'] }}">
            </label><br>
            <label>Date:<br>
                <input type="date" name="edit_date" value="{{ post['date'] }}">
            </label><br>
            <button type="submit">Save Changes</button>
        </form>

        <form method="POST" action="{{ url_for('delete_update_post', post_id=post['id']) }}"
            onsubmit="return confirm('Are you sure you want to delete this update?');">
            <button class="delete-btn">Delete</button>
        </form>
    </div>
    {% endfor %}
</div>
{% endblock %}