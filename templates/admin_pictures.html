{% extends "base.html" %}

{% block title %}Admin Pictures{% endblock %}

{% block content %}
<div class="admin-page">
    <h1>Admin: Manage Pictures</h1>

    <!-- Upload New Picture -->
    <h2>Upload New Picture</h2>
    <form method="POST" enctype="multipart/form-data" style="margin-bottom:30px;">
        <label>File:<br>
            <input type="file" name="file" required>
        </label><br>
        <label>Title:<br>
            <input type="text" name="title">
        </label><br>
        <label>Description:<br>
            <textarea name="description" rows="3"></textarea>
        </label><br>
        <label>Date Taken:<br>
            <input type="date" name="date_taken">
        </label><br>
        <button type="submit" style="padding:10px 18px; font-size:1.1em; margin-top:10px;">Upload</button>
    </form>

    <hr>

    <!-- Edit Existing Pictures -->
    <h2>Edit Existing Pictures</h2>
    {% for pic in pictures %}
    <div
        style="border:1px solid #ccc; padding:15px; margin-bottom:20px; display:flex; gap:20px; align-items:flex-start; border-radius:8px; flex-wrap:wrap;">

        <!-- Left: Thumbnail -->
        <div style="flex:0 0 150px;">
            <img src="{{ url_for('static', filename='images/' ~ pic['filename']) }}" width="100%"
                style="border-radius:6px;"><br>
        </div>

        <!-- Right: Edit form + Delete + Rotate -->
        <div style="flex:1; min-width:250px;">
            <!-- Edit Form -->
            <form method="POST" style="margin-bottom:10px;">
                <input type="hidden" name="edit_id" value="{{ pic['id'] }}">
                <label>Title:<br>
                    <input type="text" name="edit_title" value="{{ pic['title'] }}">
                </label><br>
                <label>Description:<br>
                    <textarea name="edit_description" rows="3">{{ pic['description'] }}</textarea>
                </label><br>
                <label>Date Taken:<br>
                    <input type="date" name="edit_date" value="{{ pic['date_taken'] }}">
                </label><br>
                <button type="submit" style="padding:8px 16px; font-size:1em; margin-top:5px;">Save Changes</button>
            </form>

            <!-- Rotate Buttons -->
            <form method="POST" action="{{ url_for('rotate_picture', pic_id=pic['id'], degrees=90) }}"
                style="display:inline;">
                <button type="submit" style="padding:6px 12px; font-size:0.9em;">Rotate 90°</button>
            </form>
            <form method="POST" action="{{ url_for('rotate_picture', pic_id=pic['id'], degrees=180) }}"
                style="display:inline;">
                <button type="submit" style="padding:6px 12px; font-size:0.9em;">Rotate 180°</button>
            </form>
            <form method="POST" action="{{ url_for('rotate_picture', pic_id=pic['id'], degrees=-90) }}"
                style="display:inline;">
                <button type="submit" style="padding:6px 12px; font-size:0.9em;">Rotate -90°</button>
            </form>

            <!-- Delete Form -->
            <form method="POST" action="{{ url_for('delete_picture', pic_id=pic['id']) }}"
                onsubmit="return confirm('Are you sure you want to delete this picture?');" style="margin-top:5px;">
                <button type="submit"
                    style="background-color:#d9534f; color:white; border:none; padding:8px 14px; cursor:pointer; border-radius:5px; font-size:1em;">Delete</button>
            </form>
        </div>
    </div>
    {% endfor %}
</div>
{% endblock %}